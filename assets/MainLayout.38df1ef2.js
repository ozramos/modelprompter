import{D as H,E as c,h as S,G as X,i as k,H as Ct,I as ve,J as me,K as St,n as de,L as G,M as ee,N as te,O as z,P as $t,R as ot,S as Ie,U as Ft,V as Wt,X as jt,Y as ze,Z as ut,_ as pe,$ as Kt,a0 as Yt,a1 as dt,a2 as Tt,a3 as Xt,a4 as Be,a5 as Jt,a6 as Bt,a7 as Gt,a8 as Zt,a9 as ct,aa as ea,ab as Oe,ac as Me,o as D,l as U,y as p,ad as O,x as v,ae as at,j as se,k as Q,af as M,ag as ta,ah as aa,ai as ge,Q as lt,p as ce,F as la,d as na,r as We,w as je,v as oa}from"./index.bdc5ec04.js";import{u as Ce,a as Se,g as Et,b as Vt,h as ia,c as Lt,d as zt,e as Pt,f as Dt,T as Ke,i as sa,j as Ye,k as ra,l as ua,m as da,n as ca,o as fa,r as ft,p as vt,q as va,s as ma,Q as _e,t as fe,v as ha,w as ga,x as Pe,y as pa}from"./QInput.5a3f9ba6.js";import{S as mt,s as E,l as it}from"./db.f4492f1e.js";var ba=H({name:"QToolbarTitle",props:{shrink:Boolean},setup(e,{slots:n}){const t=c(()=>"q-toolbar__title ellipsis"+(e.shrink===!0?" col-shrink":""));return()=>S("div",{class:t.value},X(n.default))}}),ya=H({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:n}){const t=c(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>S("div",{class:t.value,role:"toolbar"},X(n.default))}});function wa(){const e=k(!Ct.value);return e.value===!1&&ve(()=>{e.value=!0}),e}const It=typeof ResizeObserver<"u",ht=It===!0?{}:{style:"display:block;position:absolute;top:0;left:0;right:0;bottom:0;height:100%;width:100%;overflow:hidden;pointer-events:none;z-index:-1;",url:"about:blank"};var nt=H({name:"QResizeObserver",props:{debounce:{type:[String,Number],default:100}},emits:["resize"],setup(e,{emit:n}){let t=null,a,l={width:-1,height:-1};function u(b){b===!0||e.debounce===0||e.debounce==="0"?r():t===null&&(t=setTimeout(r,e.debounce))}function r(){if(t!==null&&(clearTimeout(t),t=null),a){const{offsetWidth:b,offsetHeight:g}=a;(b!==l.width||g!==l.height)&&(l={width:b,height:g},n("resize",l))}}const{proxy:C}=G();if(It===!0){let b;const g=o=>{a=C.$el.parentNode,a?(b=new ResizeObserver(u),b.observe(a),r()):o!==!0&&de(()=>{g(!0)})};return ve(()=>{g()}),me(()=>{t!==null&&clearTimeout(t),b!==void 0&&(b.disconnect!==void 0?b.disconnect():a&&b.unobserve(a))}),St}else{let o=function(){t!==null&&(clearTimeout(t),t=null),g!==void 0&&(g.removeEventListener!==void 0&&g.removeEventListener("resize",u,ee.passive),g=void 0)},q=function(){o(),a&&a.contentDocument&&(g=a.contentDocument.defaultView,g.addEventListener("resize",u,ee.passive),r())};const b=wa();let g;return ve(()=>{de(()=>{a=C.$el,a&&q()})}),me(o),C.trigger=u,()=>{if(b.value===!0)return S("object",{style:ht.style,tabindex:-1,type:"text/html",data:ht.url,"aria-hidden":"true",onLoad:q})}}}}),xa=H({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:n,emit:t}){const{proxy:{$q:a}}=G(),l=ot(Ie,te);if(l===te)return console.error("QHeader needs to be child of QLayout"),te;const u=k(parseInt(e.heightHint,10)),r=k(!0),C=c(()=>e.reveal===!0||l.view.value.indexOf("H")>-1||a.platform.is.ios&&l.isContainer.value===!0),b=c(()=>{if(e.modelValue!==!0)return 0;if(C.value===!0)return r.value===!0?u.value:0;const m=u.value-l.scroll.value.position;return m>0?m:0}),g=c(()=>e.modelValue!==!0||C.value===!0&&r.value!==!0),o=c(()=>e.modelValue===!0&&g.value===!0&&e.reveal===!0),q=c(()=>"q-header q-layout__section--marginal "+(C.value===!0?"fixed":"absolute")+"-top"+(e.bordered===!0?" q-header--bordered":"")+(g.value===!0?" q-header--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus":"")),$=c(()=>{const m=l.rows.value.top,y={};return m[0]==="l"&&l.left.space===!0&&(y[a.lang.rtl===!0?"right":"left"]=`${l.left.size}px`),m[2]==="r"&&l.right.space===!0&&(y[a.lang.rtl===!0?"left":"right"]=`${l.right.size}px`),y});function f(m,y){l.update("header",m,y)}function s(m,y){m.value!==y&&(m.value=y)}function h({height:m}){s(u,m),f("size",m)}function x(m){o.value===!0&&s(r,!0),t("focusin",m)}z(()=>e.modelValue,m=>{f("space",m),s(r,!0),l.animate()}),z(b,m=>{f("offset",m)}),z(()=>e.reveal,m=>{m===!1&&s(r,e.modelValue)}),z(r,m=>{l.animate(),t("reveal",m)}),z(l.scroll,m=>{e.reveal===!0&&s(r,m.direction==="up"||m.position<=e.revealOffset||m.position-m.inflectionPoint<100)});const w={};return l.instances.header=w,e.modelValue===!0&&f("size",u.value),f("space",e.modelValue),f("offset",b.value),me(()=>{l.instances.header===w&&(l.instances.header=void 0,f("size",0),f("offset",0),f("space",!1))}),()=>{const m=$t(n.default,[]);return e.elevated===!0&&m.push(S("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),m.push(S(nt,{debounce:0,onResize:h})),S("header",{class:q.value,style:$.value,onFocusin:x},m)}}}),Xe=H({name:"QItemLabel",props:{overline:Boolean,caption:Boolean,header:Boolean,lines:[Number,String]},setup(e,{slots:n}){const t=c(()=>parseInt(e.lines,10)),a=c(()=>"q-item__label"+(e.overline===!0?" q-item__label--overline text-overline":"")+(e.caption===!0?" q-item__label--caption text-caption":"")+(e.header===!0?" q-item__label--header":"")+(t.value===1?" ellipsis":"")),l=c(()=>e.lines!==void 0&&t.value>1?{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":t.value}:null);return()=>S("div",{style:l.value,class:a.value},X(n.default))}}),Je=H({name:"QList",props:{...Ce,bordered:Boolean,dense:Boolean,separator:Boolean,padding:Boolean,tag:{type:String,default:"div"}},setup(e,{slots:n}){const t=G(),a=Se(e,t.proxy.$q),l=c(()=>"q-list"+(e.bordered===!0?" q-list--bordered":"")+(e.dense===!0?" q-list--dense":"")+(e.separator===!0?" q-list--separator":"")+(a.value===!0?" q-list--dark":"")+(e.padding===!0?" q-list--padding":""));return()=>S(e.tag,{class:l.value},X(n.default))}}),Ge=H({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(e,{slots:n}){const t=c(()=>`q-item__section column q-item__section--${e.avatar===!0||e.side===!0||e.thumbnail===!0?"side":"main"}`+(e.top===!0?" q-item__section--top justify-start":" justify-center")+(e.avatar===!0?" q-item__section--avatar":"")+(e.thumbnail===!0?" q-item__section--thumbnail":"")+(e.noWrap===!0?" q-item__section--nowrap":""));return()=>S("div",{class:t.value},X(n.default))}}),gt=H({name:"QItem",props:{...Ce,...Ft,tag:{type:String,default:"div"},active:{type:Boolean,default:null},clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean},emits:["click","keyup"],setup(e,{slots:n,emit:t}){const{proxy:{$q:a}}=G(),l=Se(e,a),{hasLink:u,linkAttrs:r,linkClass:C,linkTag:b,navigateOnClick:g}=Wt(),o=k(null),q=k(null),$=c(()=>e.clickable===!0||u.value===!0||e.tag==="label"),f=c(()=>e.disable!==!0&&$.value===!0),s=c(()=>"q-item q-item-type row no-wrap"+(e.dense===!0?" q-item--dense":"")+(l.value===!0?" q-item--dark":"")+(u.value===!0&&e.active===null?C.value:e.active===!0?` q-item--active${e.activeClass!==void 0?` ${e.activeClass}`:""}`:"")+(e.disable===!0?" disabled":"")+(f.value===!0?" q-item--clickable q-link cursor-pointer "+(e.manualFocus===!0?"q-manual-focusable":"q-focusable q-hoverable")+(e.focused===!0?" q-manual-focusable--focused":""):"")),h=c(()=>{if(e.insetLevel===void 0)return null;const y=a.lang.rtl===!0?"Right":"Left";return{["padding"+y]:16+e.insetLevel*56+"px"}});function x(y){f.value===!0&&(q.value!==null&&(y.qKeyEvent!==!0&&document.activeElement===o.value?q.value.focus():document.activeElement===q.value&&o.value.focus()),g(y))}function w(y){if(f.value===!0&&jt(y,13)===!0){ze(y),y.qKeyEvent=!0;const d=new MouseEvent("click",y);d.qKeyEvent=!0,o.value.dispatchEvent(d)}t("keyup",y)}function m(){const y=$t(n.default,[]);return f.value===!0&&y.unshift(S("div",{class:"q-focus-helper",tabindex:-1,ref:q})),y}return()=>{const y={ref:o,class:s.value,style:h.value,role:"listitem",onClick:x,onKeyup:w};return f.value===!0?(y.tabindex=e.tabindex||"0",Object.assign(y,r.value)):$.value===!0&&(y["aria-disabled"]="true"),S(b.value,y,m())}}});function Ot(e,n,t){let a;function l(){a!==void 0&&(ut.remove(a),a=void 0)}return me(()=>{e.value===!0&&l()}),{removeFromHistory:l,addToHistory(){a={condition:()=>t.value===!0,handler:n},ut.add(a)}}}let xe=0,Ze,et,ke,tt=!1,pt,bt,yt,ue=null;function ka(e){_a(e)&&ze(e)}function _a(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const n=Kt(e),t=e.shiftKey&&!e.deltaX,a=!t&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),l=t||a?e.deltaY:e.deltaX;for(let u=0;u<n.length;u++){const r=n[u];if(ia(r,a))return a?l<0&&r.scrollTop===0?!0:l>0&&r.scrollTop+r.clientHeight===r.scrollHeight:l<0&&r.scrollLeft===0?!0:l>0&&r.scrollLeft+r.clientWidth===r.scrollWidth}return!0}function wt(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function Ee(e){tt!==!0&&(tt=!0,requestAnimationFrame(()=>{tt=!1;const{height:n}=e.target,{clientHeight:t,scrollTop:a}=document.scrollingElement;(ke===void 0||n!==window.innerHeight)&&(ke=t-n,document.scrollingElement.scrollTop=a),a>ke&&(document.scrollingElement.scrollTop-=Math.ceil((a-ke)/8))}))}function xt(e){const n=document.body,t=window.visualViewport!==void 0;if(e==="add"){const{overflowY:a,overflowX:l}=window.getComputedStyle(n);Ze=Et(window),et=Vt(window),pt=n.style.left,bt=n.style.top,yt=window.location.href,n.style.left=`-${Ze}px`,n.style.top=`-${et}px`,l!=="hidden"&&(l==="scroll"||n.scrollWidth>window.innerWidth)&&n.classList.add("q-body--force-scrollbar-x"),a!=="hidden"&&(a==="scroll"||n.scrollHeight>window.innerHeight)&&n.classList.add("q-body--force-scrollbar-y"),n.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,pe.is.ios===!0&&(t===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",Ee,ee.passiveCapture),window.visualViewport.addEventListener("scroll",Ee,ee.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",wt,ee.passiveCapture))}pe.is.desktop===!0&&pe.is.mac===!0&&window[`${e}EventListener`]("wheel",ka,ee.notPassive),e==="remove"&&(pe.is.ios===!0&&(t===!0?(window.visualViewport.removeEventListener("resize",Ee,ee.passiveCapture),window.visualViewport.removeEventListener("scroll",Ee,ee.passiveCapture)):window.removeEventListener("scroll",wt,ee.passiveCapture)),n.classList.remove("q-body--prevent-scroll"),n.classList.remove("q-body--force-scrollbar-x"),n.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,n.style.left=pt,n.style.top=bt,window.location.href===yt&&window.scrollTo(Ze,et),ke=void 0)}function qa(e){let n="add";if(e===!0){if(xe++,ue!==null){clearTimeout(ue),ue=null;return}if(xe>1)return}else{if(xe===0||(xe--,xe>0))return;if(n="remove",pe.is.ios===!0&&pe.is.nativeMobile===!0){ue!==null&&clearTimeout(ue),ue=setTimeout(()=>{xt(n),ue=null},100);return}}xt(n)}function Mt(){let e;return{preventBodyScroll(n){n!==e&&(e!==void 0||n===!0)&&(e=n,qa(n))}}}function Ve(e,n,t){return t<=n?n:Math.min(t,Math.max(n,e))}const kt=150;var Ca=H({name:"QDrawer",inheritAttrs:!1,props:{...Lt,...Ce,side:{type:String,default:"left",validator:e=>["left","right"].includes(e)},width:{type:Number,default:300},mini:Boolean,miniToOverlay:Boolean,miniWidth:{type:Number,default:57},breakpoint:{type:Number,default:1023},showIfAbove:Boolean,behavior:{type:String,validator:e=>["default","desktop","mobile"].includes(e),default:"default"},bordered:Boolean,elevated:Boolean,overlay:Boolean,persistent:Boolean,noSwipeOpen:Boolean,noSwipeClose:Boolean,noSwipeBackdrop:Boolean},emits:[...zt,"onLayout","miniState"],setup(e,{slots:n,emit:t,attrs:a}){const l=G(),{proxy:{$q:u}}=l,r=Se(e,u),{preventBodyScroll:C}=Mt(),{registerTimeout:b,removeTimeout:g}=Pt(),o=ot(Ie,te);if(o===te)return console.error("QDrawer needs to be child of QLayout"),te;let q,$=null,f;const s=k(e.behavior==="mobile"||e.behavior!=="desktop"&&o.totalWidth.value<=e.breakpoint),h=c(()=>e.mini===!0&&s.value!==!0),x=c(()=>h.value===!0?e.miniWidth:e.width),w=k(e.showIfAbove===!0&&s.value===!1?!0:e.modelValue===!0),m=c(()=>e.persistent!==!0&&(s.value===!0||be.value===!0));function y(i,L){if(T(),i!==!1&&o.animate(),Y(0),s.value===!0){const K=o.instances[A.value];K!==void 0&&K.belowBreakpoint===!0&&K.hide(!1),oe(1),o.isContainer.value!==!0&&C(!0)}else oe(0),i!==!1&&He(!1);b(()=>{i!==!1&&He(!0),L!==!0&&t("show",i)},kt)}function d(i,L){I(),i!==!1&&o.animate(),oe(0),Y(j.value*x.value),Ue(),L!==!0?b(()=>{t("hide",i)},kt):g()}const{show:_,hide:P}=Dt({showing:w,hideOnRouteChange:m,handleShow:y,handleHide:d}),{addToHistory:T,removeFromHistory:I}=Ot(w,P,m),F={belowBreakpoint:s,hide:P},W=c(()=>e.side==="right"),j=c(()=>(u.lang.rtl===!0?-1:1)*(W.value===!0?1:-1)),B=k(0),R=k(!1),Z=k(!1),J=k(x.value*j.value),A=c(()=>W.value===!0?"left":"right"),le=c(()=>w.value===!0&&s.value===!1&&e.overlay===!1?e.miniToOverlay===!0?e.miniWidth:x.value:0),re=c(()=>e.overlay===!0||e.miniToOverlay===!0||o.view.value.indexOf(W.value?"R":"L")>-1||u.platform.is.ios===!0&&o.isContainer.value===!0),ne=c(()=>e.overlay===!1&&w.value===!0&&s.value===!1),be=c(()=>e.overlay===!0&&w.value===!0&&s.value===!1),Qe=c(()=>"fullscreen q-drawer__backdrop"+(w.value===!1&&R.value===!1?" hidden":"")),Re=c(()=>({backgroundColor:`rgba(0,0,0,${B.value*.4})`})),he=c(()=>W.value===!0?o.rows.value.top[2]==="r":o.rows.value.top[0]==="l"),Ne=c(()=>W.value===!0?o.rows.value.bottom[2]==="r":o.rows.value.bottom[0]==="l"),V=c(()=>{const i={};return o.header.space===!0&&he.value===!1&&(re.value===!0?i.top=`${o.header.offset}px`:o.header.space===!0&&(i.top=`${o.header.size}px`)),o.footer.space===!0&&Ne.value===!1&&(re.value===!0?i.bottom=`${o.footer.offset}px`:o.footer.space===!0&&(i.bottom=`${o.footer.size}px`)),i}),N=c(()=>{const i={width:`${x.value}px`,transform:`translateX(${J.value}px)`};return s.value===!0?i:Object.assign(i,V.value)}),ye=c(()=>"q-drawer__content fit "+(o.isContainer.value!==!0?"scroll":"overflow-auto")),$e=c(()=>`q-drawer q-drawer--${e.side}`+(Z.value===!0?" q-drawer--mini-animate":"")+(e.bordered===!0?" q-drawer--bordered":"")+(r.value===!0?" q-drawer--dark q-dark":"")+(R.value===!0?" no-transition":w.value===!0?"":" q-layout--prevent-focus")+(s.value===!0?" fixed q-drawer--on-top q-drawer--mobile q-drawer--top-padding":` q-drawer--${h.value===!0?"mini":"standard"}`+(re.value===!0||ne.value!==!0?" fixed":"")+(e.overlay===!0||e.miniToOverlay===!0?" q-drawer--on-top":"")+(he.value===!0?" q-drawer--top-padding":""))),we=c(()=>{const i=u.lang.rtl===!0?e.side:A.value;return[[Ke,Ht,void 0,{[i]:!0,mouse:!0}]]}),Rt=c(()=>{const i=u.lang.rtl===!0?A.value:e.side;return[[Ke,rt,void 0,{[i]:!0,mouse:!0}]]}),Nt=c(()=>{const i=u.lang.rtl===!0?A.value:e.side;return[[Ke,rt,void 0,{[i]:!0,mouse:!0,mouseAllDir:!0}]]});function Ae(){Ut(s,e.behavior==="mobile"||e.behavior!=="desktop"&&o.totalWidth.value<=e.breakpoint)}z(s,i=>{i===!0?(q=w.value,w.value===!0&&P(!1)):e.overlay===!1&&e.behavior!=="mobile"&&q!==!1&&(w.value===!0?(Y(0),oe(0),Ue()):_(!1))}),z(()=>e.side,(i,L)=>{o.instances[L]===F&&(o.instances[L]=void 0,o[L].space=!1,o[L].offset=0),o.instances[i]=F,o[i].size=x.value,o[i].space=ne.value,o[i].offset=le.value}),z(o.totalWidth,()=>{(o.isContainer.value===!0||document.qScrollPrevented!==!0)&&Ae()}),z(()=>e.behavior+e.breakpoint,Ae),z(o.isContainer,i=>{w.value===!0&&C(i!==!0),i===!0&&Ae()}),z(o.scrollbarWidth,()=>{Y(w.value===!0?0:void 0)}),z(le,i=>{ie("offset",i)}),z(ne,i=>{t("onLayout",i),ie("space",i)}),z(W,()=>{Y()}),z(x,i=>{Y(),Fe(e.miniToOverlay,i)}),z(()=>e.miniToOverlay,i=>{Fe(i,x.value)}),z(()=>u.lang.rtl,()=>{Y()}),z(()=>e.mini,()=>{e.modelValue===!0&&(At(),o.animate())}),z(h,i=>{t("miniState",i)});function Y(i){i===void 0?de(()=>{i=w.value===!0?0:x.value,Y(j.value*i)}):(o.isContainer.value===!0&&W.value===!0&&(s.value===!0||Math.abs(i)===x.value)&&(i+=j.value*o.scrollbarWidth.value),J.value=i)}function oe(i){B.value=i}function He(i){const L=i===!0?"remove":o.isContainer.value!==!0?"add":"";L!==""&&document.body.classList[L]("q-body--drawer-toggle")}function At(){$!==null&&clearTimeout($),l.proxy&&l.proxy.$el&&l.proxy.$el.classList.add("q-drawer--mini-animate"),Z.value=!0,$=setTimeout(()=>{$=null,Z.value=!1,l&&l.proxy&&l.proxy.$el&&l.proxy.$el.classList.remove("q-drawer--mini-animate")},150)}function Ht(i){if(w.value!==!1)return;const L=x.value,K=Ve(i.distance.x,0,L);if(i.isFinal===!0){K>=Math.min(75,L)===!0?_():(o.animate(),oe(0),Y(j.value*L)),R.value=!1;return}Y((u.lang.rtl===!0?W.value!==!0:W.value)?Math.max(L-K,0):Math.min(0,K-L)),oe(Ve(K/L,0,1)),i.isFirst===!0&&(R.value=!0)}function rt(i){if(w.value!==!0)return;const L=x.value,K=i.direction===e.side,Te=(u.lang.rtl===!0?K!==!0:K)?Ve(i.distance.x,0,L):0;if(i.isFinal===!0){Math.abs(Te)<Math.min(75,L)===!0?(o.animate(),oe(1),Y(0)):P(),R.value=!1;return}Y(j.value*Te),oe(Ve(1-Te/L,0,1)),i.isFirst===!0&&(R.value=!0)}function Ue(){C(!1),He(!0)}function ie(i,L){o.update(e.side,i,L)}function Ut(i,L){i.value!==L&&(i.value=L)}function Fe(i,L){ie("size",i===!0?e.miniWidth:L)}return o.instances[e.side]=F,Fe(e.miniToOverlay,x.value),ie("space",ne.value),ie("offset",le.value),e.showIfAbove===!0&&e.modelValue!==!0&&w.value===!0&&e["onUpdate:modelValue"]!==void 0&&t("update:modelValue",!0),ve(()=>{t("onLayout",ne.value),t("miniState",h.value),q=e.showIfAbove===!0;const i=()=>{(w.value===!0?y:d)(!1,!0)};if(o.totalWidth.value!==0){de(i);return}f=z(o.totalWidth,()=>{f(),f=void 0,w.value===!1&&e.showIfAbove===!0&&s.value===!1?_(!1):i()})}),me(()=>{f!==void 0&&f(),$!==null&&(clearTimeout($),$=null),w.value===!0&&Ue(),o.instances[e.side]===F&&(o.instances[e.side]=void 0,ie("size",0),ie("offset",0),ie("space",!1))}),()=>{const i=[];s.value===!0&&(e.noSwipeOpen===!1&&i.push(Yt(S("div",{key:"open",class:`q-drawer__opener fixed-${e.side}`,"aria-hidden":"true"}),we.value)),i.push(dt("div",{ref:"backdrop",class:Qe.value,style:Re.value,"aria-hidden":"true",onClick:P},void 0,"backdrop",e.noSwipeBackdrop!==!0&&w.value===!0,()=>Nt.value)));const L=h.value===!0&&n.mini!==void 0,K=[S("div",{...a,key:""+L,class:[ye.value,a.class]},L===!0?n.mini():X(n.default))];return e.elevated===!0&&w.value===!0&&K.push(S("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),i.push(dt("aside",{ref:"content",class:$e.value,style:N.value},K,"contentclose",e.noSwipeClose!==!0&&s.value===!0,()=>Rt.value)),S("div",{class:"q-drawer-container"},i)}}}),Sa=H({name:"QPageContainer",setup(e,{slots:n}){const{proxy:{$q:t}}=G(),a=ot(Ie,te);if(a===te)return console.error("QPageContainer needs to be child of QLayout"),te;Tt(Xt,!0);const l=c(()=>{const u={};return a.header.space===!0&&(u.paddingTop=`${a.header.size}px`),a.right.space===!0&&(u[`padding${t.lang.rtl===!0?"Left":"Right"}`]=`${a.right.size}px`),a.footer.space===!0&&(u.paddingBottom=`${a.footer.size}px`),a.left.space===!0&&(u[`padding${t.lang.rtl===!0?"Right":"Left"}`]=`${a.left.size}px`),u});return()=>S("div",{class:"q-page-container",style:l.value},X(n.default))}});const{passive:_t}=ee,$a=["both","horizontal","vertical"];var Ta=H({name:"QScrollObserver",props:{axis:{type:String,validator:e=>$a.includes(e),default:"vertical"},debounce:[String,Number],scrollTarget:{default:void 0}},emits:["scroll"],setup(e,{emit:n}){const t={position:{top:0,left:0},direction:"down",directionChanged:!1,delta:{top:0,left:0},inflectionPoint:{top:0,left:0}};let a=null,l,u;z(()=>e.scrollTarget,()=>{b(),C()});function r(){a!==null&&a();const q=Math.max(0,Vt(l)),$=Et(l),f={top:q-t.position.top,left:$-t.position.left};if(e.axis==="vertical"&&f.top===0||e.axis==="horizontal"&&f.left===0)return;const s=Math.abs(f.top)>=Math.abs(f.left)?f.top<0?"up":"down":f.left<0?"left":"right";t.position={top:q,left:$},t.directionChanged=t.direction!==s,t.delta=f,t.directionChanged===!0&&(t.direction=s,t.inflectionPoint=t.position),n("scroll",{...t})}function C(){l=sa(u,e.scrollTarget),l.addEventListener("scroll",g,_t),g(!0)}function b(){l!==void 0&&(l.removeEventListener("scroll",g,_t),l=void 0)}function g(q){if(q===!0||e.debounce===0||e.debounce==="0")r();else if(a===null){const[$,f]=e.debounce?[setTimeout(r,e.debounce),clearTimeout]:[requestAnimationFrame(r),cancelAnimationFrame];a=()=>{f($),a=null}}}const{proxy:o}=G();return z(()=>o.$q.lang.rtl,r),ve(()=>{u=o.$el.parentNode,C()}),me(()=>{a!==null&&a(),b()}),Object.assign(o,{trigger:g,getPosition:()=>t}),St}}),Ba=H({name:"QLayout",props:{container:Boolean,view:{type:String,default:"hhh lpr fff",validator:e=>/^(h|l)h(h|r) lpr (f|l)f(f|r)$/.test(e.toLowerCase())},onScroll:Function,onScrollHeight:Function,onResize:Function},setup(e,{slots:n,emit:t}){const{proxy:{$q:a}}=G(),l=k(null),u=k(a.screen.height),r=k(e.container===!0?0:a.screen.width),C=k({position:0,direction:"down",inflectionPoint:0}),b=k(0),g=k(Ct.value===!0?0:Ye()),o=c(()=>"q-layout q-layout--"+(e.container===!0?"containerized":"standard")),q=c(()=>e.container===!1?{minHeight:a.screen.height+"px"}:null),$=c(()=>g.value!==0?{[a.lang.rtl===!0?"left":"right"]:`${g.value}px`}:null),f=c(()=>g.value!==0?{[a.lang.rtl===!0?"right":"left"]:0,[a.lang.rtl===!0?"left":"right"]:`-${g.value}px`,width:`calc(100% + ${g.value}px)`}:null);function s(d){if(e.container===!0||document.qScrollPrevented!==!0){const _={position:d.position.top,direction:d.direction,directionChanged:d.directionChanged,inflectionPoint:d.inflectionPoint.top,delta:d.delta.top};C.value=_,e.onScroll!==void 0&&t("scroll",_)}}function h(d){const{height:_,width:P}=d;let T=!1;u.value!==_&&(T=!0,u.value=_,e.onScrollHeight!==void 0&&t("scrollHeight",_),w()),r.value!==P&&(T=!0,r.value=P),T===!0&&e.onResize!==void 0&&t("resize",d)}function x({height:d}){b.value!==d&&(b.value=d,w())}function w(){if(e.container===!0){const d=u.value>b.value?Ye():0;g.value!==d&&(g.value=d)}}let m=null;const y={instances:{},view:c(()=>e.view),isContainer:c(()=>e.container),rootRef:l,height:u,containerHeight:b,scrollbarWidth:g,totalWidth:c(()=>r.value+g.value),rows:c(()=>{const d=e.view.toLowerCase().split(" ");return{top:d[0].split(""),middle:d[1].split(""),bottom:d[2].split("")}}),header:Be({size:0,offset:0,space:!1}),right:Be({size:300,offset:0,space:!1}),footer:Be({size:0,offset:0,space:!1}),left:Be({size:300,offset:0,space:!1}),scroll:C,animate(){m!==null?clearTimeout(m):document.body.classList.add("q-body--layout-animate"),m=setTimeout(()=>{m=null,document.body.classList.remove("q-body--layout-animate")},155)},update(d,_,P){y[d][_]=P}};if(Tt(Ie,y),Ye()>0){let P=function(){d=null,_.classList.remove("hide-scrollbar")},T=function(){if(d===null){if(_.scrollHeight>a.screen.height)return;_.classList.add("hide-scrollbar")}else clearTimeout(d);d=setTimeout(P,300)},I=function(F){d!==null&&F==="remove"&&(clearTimeout(d),P()),window[`${F}EventListener`]("resize",T)},d=null;const _=document.body;z(()=>e.container!==!0?"add":"remove",I),e.container!==!0&&I("add"),Jt(()=>{I("remove")})}return()=>{const d=Bt(n.default,[S(Ta,{onScroll:s}),S(nt,{onResize:h})]),_=S("div",{class:o.value,style:q.value,ref:e.container===!0?void 0:l,tabindex:-1},d);return e.container===!0?S("div",{class:"q-layout-container overflow-hidden",ref:l},[S(nt,{onResize:x}),S("div",{class:"absolute-full",style:$.value},[S("div",{class:"scroll",style:f.value},[_])])]):_}}});const Ea="modelprompter",Va="0.0.5",La="Turn your desktop folders into unstructured databases and simulate entire communities of expert and autonomous AIs around them",za="ModelPrompter",Pa="Oz Ramos <0xozram@gmail.com>",Da={start:"npx cross-env NODE_ENV=development quasar dev",dev:"npx cross-env NODE_ENV=development quasar dev",build:"npx cross-env NODE_ENV=production NODE_OPTIONS=--max-old-space-size=32768 quasar build",test:"npx cross-env NODE_ENV=production NODE_OPTIONS=--max-old-space-size=32768 npx http-server ./dist/spa -p 8000",deploy:"gh-pages.sh","cloud:export":"npx dexie-cloud export dexie-export.json"},Ia={"@agoose77/markdown-it-mermaid":"^1.1.0","@quasar/extras":"^1.0.0","@vueuse/rxjs":"^10.1.2",copyfiles:"^2.4.1",dexie:"^4.0.1-alpha.10","dexie-cloud-addon":"^4.0.1-beta.40",dompurify:"^3.0.3",dotenv:"^16.0.3","dreambase-library":"^1.0.19","file-saver":"^2.0.5","highlight.js":"^11.8.0",install:"^0.13.0",langchain:"^0.0.69","markdown-it":"^13.0.1","markdown-it-mermaid":"^0.2.5","monaco-editor":"^0.38.0","monaco-editor-vue3":"^0.1.6",pug:"^3.0.2","push-dir":"^0.4.1",quasar:"^2.6.0",remove:"^0.1.5",vue:"^3.0.0","vue-router":"^4.0.0"},Oa={"@quasar/app-vite":"^1.0.0",autoprefixer:"^10.4.2","cross-env":"^7.0.3",postcss:"^8.4.14","quasar-app-extension-qdraggabletree":"^2.0.5","vite-plugin-top-level-await":"^1.3.0","vite-plugin-wasm":"^3.2.2"},Ma={node:"^18 || ^16 || ^14.19",npm:">= 6.13.4",yarn:">= 1.21.1"};var Qa={name:Ea,version:Va,description:La,productName:za,author:Pa,private:!0,scripts:Da,dependencies:Ia,devDependencies:Oa,engines:Ma},ae=H({name:"QCardSection",props:{tag:{type:String,default:"div"},horizontal:Boolean},setup(e,{slots:n}){const t=c(()=>`q-card__section q-card__section--${e.horizontal===!0?"horiz row no-wrap":"vert"}`);return()=>S(e.tag,{class:t.value},X(n.default))}}),qe=H({name:"QCardActions",props:{...Gt,vertical:Boolean},setup(e,{slots:n}){const t=Zt(e),a=c(()=>`q-card__actions ${t.value} q-card__actions--${e.vertical===!0?"vert column":"horiz row"}`);return()=>S("div",{class:a.value},X(n.default))}}),De=H({name:"QCard",props:{...Ce,tag:{type:String,default:"div"},square:Boolean,flat:Boolean,bordered:Boolean},setup(e,{slots:n}){const{proxy:{$q:t}}=G(),a=Se(e,t),l=c(()=>"q-card"+(a.value===!0?" q-card--dark q-dark":"")+(e.bordered===!0?" q-card--bordered":"")+(e.square===!0?" q-card--square no-border-radius":"")+(e.flat===!0?" q-card--flat no-shadow":""));return()=>S(e.tag,{class:l.value},X(n.default))}});let Le=0;const Ra={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},qt={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]};var st=H({name:"QDialog",inheritAttrs:!1,props:{...Lt,...ra,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,position:{type:String,default:"standard",validator:e=>e==="standard"||["top","bottom","left","right"].includes(e)}},emits:[...zt,"shake","click","escapeKey"],setup(e,{slots:n,emit:t,attrs:a}){const l=G(),u=k(null),r=k(!1),C=k(!1);let b=null,g=null,o,q;const $=c(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:f}=Mt(),{registerTimeout:s}=Pt(),{registerTick:h,removeTick:x}=ua(),{transitionProps:w,transitionStyle:m}=da(e,()=>qt[e.position][0],()=>qt[e.position][1]),{showPortal:y,hidePortal:d,portalIsAccessible:_,renderPortal:P}=ca(l,u,Ne,"dialog"),{hide:T}=Dt({showing:r,hideOnRouteChange:$,handleShow:Z,handleHide:J,processOnMount:!0}),{addToHistory:I,removeFromHistory:F}=Ot(r,T,$),W=c(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${Ra[e.position]}`+(C.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),j=c(()=>r.value===!0&&e.seamless!==!0),B=c(()=>e.autoClose===!0?{onClick:Qe}:{}),R=c(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${j.value===!0?"modal":"seamless"}`,a.class]);z(()=>e.maximized,V=>{r.value===!0&&be(V)}),z(j,V=>{f(V),V===!0?(va(he),ma(re)):(ft(he),vt(re))});function Z(V){I(),g=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,be(e.maximized),y(),C.value=!0,e.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),h(A)):x(),s(()=>{if(l.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:N,bottom:ye}=document.activeElement.getBoundingClientRect(),{innerHeight:$e}=window,we=window.visualViewport!==void 0?window.visualViewport.height:$e;N>0&&ye>we/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-we,ye>=$e?1/0:Math.ceil(document.scrollingElement.scrollTop+ye-we/2))),document.activeElement.scrollIntoView()}q=!0,u.value.click(),q=!1}y(!0),C.value=!1,t("show",V)},e.transitionDuration)}function J(V){x(),F(),ne(!0),C.value=!0,d(),g!==null&&(((V&&V.type.indexOf("key")===0?g.closest('[tabindex]:not([tabindex^="-"])'):void 0)||g).focus(),g=null),s(()=>{d(!0),C.value=!1,t("hide",V)},e.transitionDuration)}function A(V){fa(()=>{let N=u.value;N===null||N.contains(document.activeElement)===!0||(N=(V!==""?N.querySelector(V):null)||N.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||N.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||N.querySelector("[autofocus], [data-autofocus]")||N,N.focus({preventScroll:!0}))})}function le(V){V&&typeof V.focus=="function"?V.focus({preventScroll:!0}):A(),t("shake");const N=u.value;N!==null&&(N.classList.remove("q-animate--scale"),N.classList.add("q-animate--scale"),b!==null&&clearTimeout(b),b=setTimeout(()=>{b=null,u.value!==null&&(N.classList.remove("q-animate--scale"),A())},170))}function re(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&le():(t("escapeKey"),T()))}function ne(V){b!==null&&(clearTimeout(b),b=null),(V===!0||r.value===!0)&&(be(!1),e.seamless!==!0&&(f(!1),ft(he),vt(re))),V!==!0&&(g=null)}function be(V){V===!0?o!==!0&&(Le<1&&document.body.classList.add("q-body--dialog"),Le++,o=!0):o===!0&&(Le<2&&document.body.classList.remove("q-body--dialog"),Le--,o=!1)}function Qe(V){q!==!0&&(T(V),t("click",V))}function Re(V){e.persistent!==!0&&e.noBackdropDismiss!==!0?T(V):e.noShake!==!0&&le()}function he(V){e.allowFocusOutside!==!0&&_.value===!0&&ea(u.value,V.target)!==!0&&A('[tabindex]:not([tabindex="-1"])')}Object.assign(l.proxy,{focus:A,shake:le,__updateRefocusTarget(V){g=V||null}}),me(ne);function Ne(){return S("div",{role:"dialog","aria-modal":j.value===!0?"true":"false",...a,class:R.value},[S(ct,{name:"q-transition--fade",appear:!0},()=>j.value===!0?S("div",{class:"q-dialog__backdrop fixed-full",style:m.value,"aria-hidden":"true",tabindex:-1,onClick:Re}):null),S(ct,w.value,()=>r.value===!0?S("div",{ref:u,class:W.value,style:m.value,tabindex:-1,...B.value},X(n.default)):null)])}return P}});const Na={key:0,class:"text-h4"},Aa={key:1,class:"text-h4"},Ha={__name:"NewChannel",setup(e,{expose:n}){const t=k(!1),a=k("Untitled"),l=k(mt),u=Oe(),r=Me();let C=k(!1);const b=k(null);function g(f={}){t.value=!0,C.value=!!f.id||!1,b.value=f.id||null,f.id?(a.value=f.name,l.value=f.prompt):(a.value="Untitled",l.value=mt)}function o(){t.value=!1}async function q(){const f=await E.createChannel({name:a.value,prompt:l.value});await E.createMessage({name:"System",channel:"chnSystem",text:`<p><strong>Channel created</strong>: ${f.name}<p><strong>With prompt:</strong><pre>${f.prompt}</pre>`}),o(),u.notify({message:"Channel created"}),r.push({name:"channel",params:{id:f.id}})}async function $(){const f=await E.db.channels.get(b.value),s=await E.updateChannel({id:b.value,name:a.value,prompt:l.value,realmId:f?.realmId});await E.createMessage({name:"System",channel:"chnSystem",text:`<p><strong>Channel updated</strong>: ${s.name}<p><strong>With prompt:</strong><pre>${s.prompt}</pre>`}),o(),u.notify({message:"Channel updated"}),r.push({name:"channel",params:{id:s.id}})}return n({showModal:g}),(f,s)=>(D(),U(M,{class:"full-width q-pl-sm",icon:"chat",onClick:s[3]||(s[3]=h=>g())},{default:p(()=>[O("New Channel"),v(st,{class:"fullscreen",modelValue:t.value,"onUpdate:modelValue":s[2]||(s[2]=h=>t.value=h)},{default:p(()=>[v(De,{class:"flex column"},{default:p(()=>[v(ae,{class:"flex-unset"},{default:p(()=>[at(C)?(D(),se("div",Na,"Edit Channel")):(D(),se("div",Aa,"New Channel"))]),_:1}),v(ae,{class:"q-pb-none"},{default:p(()=>[Q("p",null,[v(_e,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=h=>a.value=h),label:"Channel name",outlined:""},null,8,["modelValue"])])]),_:1}),v(ae,{class:"flex-auto align-stretch"},{default:p(()=>[v(_e,{class:"full-height flex-auto",modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=h=>l.value=h),label:"Initial system prompt",outlined:"",type:"textarea",autofocus:""},null,8,["modelValue"])]),_:1}),v(qe,{class:"flex-unset",align:"right"},{default:p(()=>[v(M,{flat:"",onClick:o},{default:p(()=>[O("Cancel")]),_:1}),v(fe),at(C)?(D(),U(M,{key:0,onClick:$},{default:p(()=>[O("Update channel")]),_:1})):(D(),U(M,{key:1,onClick:q},{default:p(()=>[O("Create channel")]),_:1}))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};function Ua(e,n){const t=k(null),a=c(()=>e.disable===!0?null:S("span",{ref:t,class:"no-outline",tabindex:-1}));function l(u){const r=n.value;u!==void 0&&u.type.indexOf("key")===0?r!==null&&document.activeElement!==r&&r.contains(document.activeElement)===!0&&r.focus():t.value!==null&&(u===void 0||r!==null&&r.contains(u.target)===!0)&&t.value.focus()}return{refocusTargetEl:a,refocusTarget:l}}var Fa={xs:30,sm:35,md:40,lg:50,xl:60};const Wa={...Ce,...aa,...ha,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:e=>e==="tf"||e==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},ja=["update:modelValue"];function Ka(e,n){const{props:t,slots:a,emit:l,proxy:u}=G(),{$q:r}=u,C=Se(t,r),b=k(null),{refocusTargetEl:g,refocusTarget:o}=Ua(t,b),q=ta(t,Fa),$=c(()=>t.val!==void 0&&Array.isArray(t.modelValue)),f=c(()=>{const B=ge(t.val);return $.value===!0?t.modelValue.findIndex(R=>ge(R)===B):-1}),s=c(()=>$.value===!0?f.value>-1:ge(t.modelValue)===ge(t.trueValue)),h=c(()=>$.value===!0?f.value===-1:ge(t.modelValue)===ge(t.falseValue)),x=c(()=>s.value===!1&&h.value===!1),w=c(()=>t.disable===!0?-1:t.tabindex||0),m=c(()=>`q-${e} cursor-pointer no-outline row inline no-wrap items-center`+(t.disable===!0?" disabled":"")+(C.value===!0?` q-${e}--dark`:"")+(t.dense===!0?` q-${e}--dense`:"")+(t.leftLabel===!0?" reverse":"")),y=c(()=>{const B=s.value===!0?"truthy":h.value===!0?"falsy":"indet",R=t.color!==void 0&&(t.keepColor===!0||(e==="toggle"?s.value===!0:h.value!==!0))?` text-${t.color}`:"";return`q-${e}__inner relative-position non-selectable q-${e}__inner--${B}${R}`}),d=c(()=>{const B={type:"checkbox"};return t.name!==void 0&&Object.assign(B,{".checked":s.value,"^checked":s.value===!0?"checked":void 0,name:t.name,value:$.value===!0?t.val:t.trueValue}),B}),_=ga(d),P=c(()=>{const B={tabindex:w.value,role:e==="toggle"?"switch":"checkbox","aria-label":t.label,"aria-checked":x.value===!0?"mixed":s.value===!0?"true":"false"};return t.disable===!0&&(B["aria-disabled"]="true"),B});function T(B){B!==void 0&&(ze(B),o(B)),t.disable!==!0&&l("update:modelValue",I(),B)}function I(){if($.value===!0){if(s.value===!0){const B=t.modelValue.slice();return B.splice(f.value,1),B}return t.modelValue.concat([t.val])}if(s.value===!0){if(t.toggleOrder!=="ft"||t.toggleIndeterminate===!1)return t.falseValue}else if(h.value===!0){if(t.toggleOrder==="ft"||t.toggleIndeterminate===!1)return t.trueValue}else return t.toggleOrder!=="ft"?t.trueValue:t.falseValue;return t.indeterminateValue}function F(B){(B.keyCode===13||B.keyCode===32)&&ze(B)}function W(B){(B.keyCode===13||B.keyCode===32)&&T(B)}const j=n(s,x);return Object.assign(u,{toggle:T}),()=>{const B=j();t.disable!==!0&&_(B,"unshift",` q-${e}__native absolute q-ma-none q-pa-none`);const R=[S("div",{class:y.value,style:q.value,"aria-hidden":"true"},B)];g.value!==null&&R.push(g.value);const Z=t.label!==void 0?Bt(a.default,[t.label]):X(a.default);return Z!==void 0&&R.push(S("div",{class:`q-${e}__label q-anchor--skip`},Z)),S("div",{ref:b,class:m.value,...P.value,onClick:T,onKeydown:F,onKeyup:W},R)}}var Ya=H({name:"QToggle",props:{...Wa,icon:String,iconColor:String},emits:ja,setup(e){function n(t,a){const l=c(()=>(t.value===!0?e.checkedIcon:a.value===!0?e.indeterminateIcon:e.uncheckedIcon)||e.icon),u=c(()=>t.value===!0?e.iconColor:null);return()=>[S("div",{class:"q-toggle__track"}),S("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},l.value!==void 0?[S(lt,{name:l.value,color:u.value})]:void 0)]}return Ka("toggle",n)}});const Xa=typeof Buffer<"u"?e=>ArrayBuffer.isView(e)?Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"):Buffer.from(e).toString("base64"):e=>btoa(String.fromCharCode.apply(null,ArrayBuffer.isView(e)?e:new Uint8Array(e))),Ja=Q("div",{class:"text-h4"},"Sign in",-1),Ga={key:0},Za=Q("strong",null,"Regsitration isn't required",-1),el=Q("a",{href:"https://dexie.org/cloud",target:"_blank"},"Dexie Cloud",-1),tl={key:1},al=Q("strong",{class:"text-red"},"Registration is closed.",-1),ll=Q("a",{href:"https://dexie.org/cloud",target:"_blank"},"Dexie Cloud",-1),nl=Q("div",{class:"text-h4"},"Enter OTP",-1),ol=Q("p",null,"Check your email for an access token from Dexie.org (the cloud provider for this app) and enter the token below",-1),Qt={__name:"LoginLogout",setup(e){const n=Oe(),t=Me(),a=k(!1);k(!1);const l=k(!1),u=k(!1),r=k(""),C=k(null),b=k(""),g=k(""),o=k(null),q=k(!1),$=k(!1),f=!0,s=!!Number("0"),h=k(!1),x=Pe(it(()=>E.db.cloud.currentUser)||{});z(x,()=>{h.value=E.db.cloud.currentUserId&&E.db.cloud.currentUserId!=="unauthorized",l.value&&h.value&&n.notify({message:"Logged in"})}),ve(()=>{h.value=E.db.cloud.currentUserId&&E.db.cloud.currentUserId!=="unauthorized"});async function w(){await E.db.$logins.clear(),n.notify({message:"Logged out"}),window.indexedDB.databases().then(P=>{for(var T=0;T<P.length;T++)window.indexedDB.deleteDatabase(P[T].name)}),window.location.reload(),y()}async function m(){a.value=!0,u.value=!1,q.value=!1,l.value=!1,de(()=>{setTimeout(()=>{C.value.focus()},10)})}function y(){a.value=!1}async function d(){if(!r.value){n.notify({message:"Please enter an email"});return}u.value=!1,q.value=!0,await de(),setTimeout(async()=>{const P=await fetch(`${E.db.cloud.options.databaseUrl}/token`,{body:JSON.stringify({email:r.value,grant_type:"otp",scopes:["ACCESS_DB"]}),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"});o.value=await P.json(),u.value=!0,q.value=!1,l.value=!0,n.notify({message:"Email sent"}),de(()=>{b.value.focus()})},0)}async function _(){const P=function(J){const A=Xa(J);return T(A)};function T(J){let A=`-----BEGIN PUBLIC KEY-----
`;for(;J.length>0;)A+=J.substring(0,64)+`
`,J=J.substring(64);return A=A+"-----END PUBLIC KEY-----",A}if(!crypto.subtle)throw typeof location<"u"&&location.protocol==="http:"?new Error("Dexie Cloud Addon needs to use WebCrypto, but your browser has disabled it due to being served from an insecure location. Please serve it from https or http://localhost:<port> (See https://stackoverflow.com/questions/46670556/how-to-enable-crypto-subtle-for-unsecure-origins-in-chrome/46671627#46671627)"):new Error("This browser does not support WebCrypto.");const{privateKey:I,publicKey:F}=await crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!1,["sign","verify"]);if(!I||!F)throw new Error("Could not generate RSA keypair");E.db.cloud.currentUser.nonExportablePrivateKey=I;const W=await crypto.subtle.exportKey("spki",F),j=P(W);E.db.cloud.currentUser.publicKey=F;const B=r.value==="public@demo.local",R=await fetch(`${E.db.cloud.options.databaseUrl}/token`,{body:JSON.stringify({email:r.value,otp:g.value,demo_user:B?"public@demo.local":void 0,otp_id:o.value.otp_id,grant_type:B?"demo":"otp",public_key:j,scopes:["ACCESS_DB"]}),method:"post",headers:{"Content-Type":"application/json"},mode:"cors"});if(R.status!==200){n.notify({message:"Invalid token",color:"negative"});return}const Z=await R.json();E.db.cloud.options.fetchTokens=()=>Z,await E.db.cloud.login({email:r.value,grant_type:"otp"}),y(),t.push("/")}return(P,T)=>(D(),se(la,null,[s&&!h.value&&s&&f?(D(),U(M,{key:0,onClick:T[5]||(T[5]=I=>m()),icon:"login"},{default:p(()=>[O("Sign in"),v(st,{modelValue:a.value,"onUpdate:modelValue":T[4]||(T[4]=I=>a.value=I)},{default:p(()=>[u.value?(D(),U(De,{key:1,style:{height:"auto !important","min-width":"350px","max-width":"600px !important",width:"auto !important"}},{default:p(()=>[v(ae,null,{default:p(()=>[nl,ol,Q("div",null,[v(_e,{ref_key:"$email",ref:C,modelValue:r.value,"onUpdate:modelValue":T[1]||(T[1]=I=>r.value=I),label:"Email",type:"email",disabled:q.value},null,8,["modelValue","disabled"])]),Q("div",null,[v(_e,{ref_key:"$otpToken",ref:b,modelValue:g.value,"onUpdate:modelValue":T[2]||(T[2]=I=>g.value=I),label:"Enter OTP token"},null,8,["modelValue"])])]),_:1}),v(qe,{align:"right"},{default:p(()=>[v(M,{flat:"",onClick:y},{default:p(()=>[O("Cancel")]),_:1}),v(fe),v(M,{onClick:T[3]||(T[3]=I=>_()),disabled:!r.value||!g.value,loading:$.value},{default:p(()=>[O("Login")]),_:1},8,["disabled","loading"])]),_:1})]),_:1})):(D(),U(De,{key:0,style:{height:"auto !important","min-width":"350px","max-width":"600px !important",width:"auto !important"}},{default:p(()=>[v(ae,null,{default:p(()=>[Ja]),_:1}),v(ae,null,{default:p(()=>[s?(D(),se("p",Ga,[Za,O(", but if you want to sync across devices or invite others, login below to get an access token emailed from "),el,O(" (our data store provider)")])):(D(),se("p",tl,[al,O(" If you're in beta, sign in below to get an access token emailed from "),ll,O(" (our data store provider)")])),Q("div",null,[v(_e,{ref_key:"$email",ref:C,modelValue:r.value,"onUpdate:modelValue":T[0]||(T[0]=I=>r.value=I),label:"Email",type:"email",disabled:q.value},null,8,["modelValue","disabled"])])]),_:1}),v(qe,{align:"right"},{default:p(()=>[v(M,{flat:"",onClick:y},{default:p(()=>[O("Cancel")]),_:1}),v(fe),v(M,{onClick:d,loading:q.value},{default:p(()=>[O("Email access token")]),_:1},8,["loading"])]),_:1})]),_:1}))]),_:1},8,["modelValue"])]),_:1})):ce("",!0),h.value&&s&&f?(D(),U(M,{key:1,color:"negative",onClick:T[6]||(T[6]=I=>w()),icon:"logout"},{default:p(()=>[O("Sign out")]),_:1})):ce("",!0)],64))}},il=Q("div",{class:"text-h4"},"Settings",-1),sl=Q("p",{class:"text-h6"},"Cloud sync",-1),rl={key:0},ul={key:0},dl={key:1},cl=Q("p",{class:"text-h6"},"Local .json file",-1),fl=Q("label",{class:"q-btn bg-light text-white non-selectable no-outline q-btn--standard q-btn--rectangle q-btn--actionable q-focusable q-hoverable",for:"jsonFile",color:"light",style:{"line-height":"2.5em"}},"Import",-1),vl={__name:"Settings",setup(e){const n=Oe(),t=Me(),a=k(!1),l=k(!1);k(null);const u=!!Number("0"),r=k(!1),C=Pe(E.db?.cloud?.currentUser||{});z(C,()=>{r.value=E.db.cloud.currentUserId&&E.db.cloud.currentUserId!=="unauthorized"});function b(f={}){a.value=!0}function g(){a.value=!1}Pe(it(async()=>await E.getSettings())),ve(async()=>{const f=await E.getSettings();l.value=!!f.isCloudSyncEnabled});async function o(){await E.exportDatabase(),g(),n.notify({message:"Database exported"})}async function q(f){!f.target.files.length||(await E.importDatabase(f.target.files[0],n),t.push("/"),g())}async function $(){await E.deleteDatabase(),t.push("/"),g()}return(f,s)=>(D(),U(M,{class:"full-width q-pl-sm q-pr-none",color:"light",icon:"settings",onClick:s[5]||(s[5]=h=>b())},{default:p(()=>[v(st,{modelValue:a.value,"onUpdate:modelValue":s[4]||(s[4]=h=>a.value=h)},{default:p(()=>[v(De,{style:{height:"auto !important","max-width":"100% !important",width:"500px !important"}},{default:p(()=>[u?(D(),U(ae,{key:0},{default:p(()=>[il]),_:1})):ce("",!0),u?(D(),U(ae,{key:1},{default:p(()=>[sl,r.value?(D(),se("p",rl,[v(Ya,{class:"q-mr-xl",modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=h=>l.value=h),label:"Enable cloud sync",color:"primary"},null,8,["modelValue"]),l.value?(D(),se("strong",ul,"(Syncing will start once you update)")):ce("",!0)])):(D(),se("p",dl,[v(Qt,null,{default:p(()=>[O("(Registration will be available soon)")]),_:1})]))]),_:1})):ce("",!0),v(ae,null,{default:p(()=>[cl,v(qe,{class:"q-px-none"},{default:p(()=>[fl,Q("input",{class:"hidden",type:"file",id:"jsonFile",accept:".json",style:{display:"none"},onChange:s[1]||(s[1]=h=>q(h))},null,32),v(M,{class:"q-ml-md",onClick:s[2]||(s[2]=h=>o())},{default:p(()=>[O("Export")]),_:1})]),_:1})]),_:1}),v(qe,{class:"q-mt-xl",align:"right"},{default:p(()=>[v(M,{flat:"",onClick:g},{default:p(()=>[O("Cancel")]),_:1}),v(fe),v(M,{color:"negative",onClick:s[3]||(s[3]=h=>$())},{default:p(()=>[O("Delete all data")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},ml=["src"],hl=["src"],gl=["href"],pl={class:"q-ml-sm",style:{"font-size":".65em",display:"inline-block",transform:"translate(0, -3px)"}},bl={class:"q-pr-sm"},_l={__name:"MainLayout",setup(e){const n=k(globalThis.mp.env),t=Oe(),a=Me(),l=Pe(it(async()=>await u()));async function u(){const h=await E.getChannels(),x=h.find(m=>m.id==="chnSystem");x&&(h.splice(h.indexOf(x),1),h.unshift(x));let w=h.map(m=>({id:m.id,label:m.name,channel:m,children:[]}));return w=[{id:0,label:"Channels",channel:{},children:w}],r.value=w,h}setInterval(async()=>{l.value=await u()},1e3);const r=k([]),C=na(h=>{let w=h[0].children.map(y=>y.channel);const m=w.find(y=>y.id==="chnSystem");m&&(w.splice(w.indexOf(m),1),w.unshift(m)),w=w.map((y,d)=>(y.sort=d,y)),E.updateSorts(w)},500,{leading:!1,trailing:!0});z(r,C,{deep:!0});const b=k(!1);function g(){b.value=!b.value}const o=k(null);function q(h,x){return o.value.showModal(x),h.preventDefault(),h.stopPropagation(),!1}async function $(h,x){return await E.deleteChannel(x.id),await E.createMessage({name:"System",channel:"chnSystem",text:`<strong>Channel deleted</strong>: ${x.name}`}),t.notify({message:`Deleted channel ${x.name}`}),h.preventDefault(),h.stopPropagation(),a.push("/"),!1}async function f(h,x){let w=Object.assign({},x,{name:`${x.name} (copy)`,realmId:s(x)});delete w.id;const m=await E.createChannel(w);return(await E.getMessagesWithSystemPrompt(x.id)).forEach(async d=>{d=Object.assign({},d),delete d.id;const _=await E.createMessage({...d,channel:m.id,realmId:m.realmId});await E.updateMessage(_.id,{created:d.created},!0)}),t.notify({message:`Copied channel ${x.name}`}),h.preventDefault(),h.stopPropagation(),a.push({name:"channel",params:{id:m.id}}),!1}function s(h){return!E.db?.cloud?.currentUserId||["unauthorized"].includes(E.db?.cloud?.currentUserId)?null:h.value?.realmId==="rlm-public"?"rlm-public":E.db.cloud.currentUserId}return(h,x)=>{const w=We("router-link"),m=We("QDraggableTree"),y=We("router-view");return D(),U(Ba,{view:"lHh Lpr lFf"},{default:p(()=>[v(xa,null,{default:p(()=>[v(ya,null,{default:p(()=>[v(M,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:g}),v(ba,null,{default:p(()=>[v(w,{class:"text-decoration-none text-white",to:"/"},{default:p(()=>[Q("img",{class:"lt-md q-mr-sm",src:n.value.logo?.small||"/logo-title-small.png",height:"32",style:{"vertical-align":"middle"}},null,8,ml),Q("img",{class:"gt-sm q-mr-sm",src:n.value.logo?.title||"/logo-title.png",height:"32",style:{"vertical-align":"middle"}},null,8,hl)]),_:1}),Q("a",{href:n.value.logo?.release||"https://github.com/ozramos/modelprompter/releases",target:"_blank"},[Q("small",pl,je(at(Qa).version),1)],8,gl)]),_:1}),v(fe,{style:{"flex-grow":"0 !important"}}),v(Qt)]),_:1}),v(fe)]),_:1}),v(Ca,{class:"flex-drawer full-height width-inherit",modelValue:b.value,"onUpdate:modelValue":x[2]||(x[2]=d=>b.value=d),"show-if-above":"",bordered:""},{default:p(()=>[v(Je,null,{default:p(()=>[v(Xe,{header:""},{default:p(()=>[O("Channels")]),_:1})]),_:1}),v(Je,{style:{"overflow-y":"auto","overflow-x":"hidden"}},{default:p(()=>[v(m,{class:"q-draggable-tree",modelValue:r.value,"onUpdate:modelValue":x[1]||(x[1]=d=>r.value=d),data:r.value,rowkey:"id"},{body:p(({item:d})=>[(D(),U(gt,oa({class:"channel-menu-item",key:d.id},d.channel,{clickable:"",to:{name:"channel",params:{id:d.id}}}),{default:p(()=>[v(Ge,{avatar:""},{default:p(()=>[d.channel.id==="chnSystem"?(D(),U(lt,{key:0,name:"hive"})):(D(),U(lt,{key:1,name:d.channel.realmId==="rlm-public"?"public":"chat"},null,8,["name"]))]),_:2},1024),v(Ge,null,{default:p(()=>[v(Xe,{lines:"1"},{default:p(()=>[O(je(d.channel.name),1)]),_:2},1024),d.channel.caption?(D(),U(Xe,{key:0,caption:""},{default:p(()=>[O(je(d.channel.caption),1)]),_:2},1024)):ce("",!0)]),_:2},1024),v(Ge,null,{default:p(()=>[v(M,{rel:"edit",flat:"",dense:"",icon:"edit","aria-label":"Edit",onClick:_=>q(_,d.channel)},null,8,["onClick"]),v(M,{rel:"edit",flat:"",dense:"",icon:"content_copy","aria-label":"Copy",onClick:_=>f(_,d.channel)},null,8,["onClick"]),d.channel.id!=="chnSystem"?(D(),U(M,{key:0,rel:"delete",flat:"",dense:"",icon:"delete","aria-label":"Delete",onClick:_=>$(_,d.channel)},null,8,["onClick"])):ce("",!0)]),_:2},1024),v(pa,{"touch-position":"","context-menu":"",onShow:x[0]||(x[0]=_=>_.preventDefault()&&_.stopPropagation())},{default:p(()=>[v(M,{class:"q-pl-sm",rel:"edit",flat:"",round:"",icon:"edit","aria-label":"Edit",onClick:_=>q(_,d.channel)},null,8,["onClick"]),v(M,{rel:"edit",flat:"",round:"",icon:"content_copy","aria-label":"Copy",onClick:_=>f(_,d.channel)},null,8,["onClick"]),v(M,{rel:"delete",flat:"",round:"",icon:"delete","aria-label":"Delete",onClick:_=>$(_,d.channel)},null,8,["onClick"])]),_:2},1024)]),_:2},1040,["to"]))]),_:1},8,["modelValue","data"])]),_:1}),v(fe),v(Je,{class:"q-pb-sm",dense:""},{default:p(()=>[v(gt,null,{default:p(()=>[Q("div",bl,[v(vl)]),v(Ha,{ref_key:"$newChannel",ref:o},null,512)]),_:1})]),_:1})]),_:1},8,["modelValue"]),v(Sa,null,{default:p(()=>[v(y)]),_:1})]),_:1})}}};export{_l as default};
